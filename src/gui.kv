
#:import C kivy.utils.get_color_from_hex
#:import RiseInTransition kivy.uix.screenmanager.RiseInTransition
#:import FallOutTransition kivy.uix.screenmanager.FallOutTransition
#:import FadeTransition kivy.uix.screenmanager.FadeTransition 
#:import CardTransition kivy.uix.screenmanager.CardTransition
#:import SwapTransition kivy.uix.screenmanager.SwapTransition 
#:import WipeTransition kivy.uix.screenmanager.WipeTransition
#:import SlideTransition kivy.uix.screenmanager.SlideTransition
#:import create_log create_logs.create_log
#:import activities create_logs.activities
#:import strftime time.strftime

##:import NoTransition kivy.uix.screenmanager.

<AdminInfoEditField>:
	hint_text:""
	text:""
	size_hint_y:None
	height:60
	MDTextField:
		id:txt
		hint_text:self.parent.hint_text
		text:self.parent.text
		size_hint_x:None
		width:200
		write_tab:False

<AdminInfoLabel>:
	text:""
	title:""
	spacing:-20
	size_hint_y:None
	height:60		
	orientation:"vertical"
	MDLabel:
		text:root.title
		color:.53,.53,.53,1
		font_size:14
	MDLabel:
		text:root.text
		color: (0,0,0,1) if app.theme_cls.theme_style=="Light" else (1,1,1,1)

<Section@BoxLayout>:
	size_hint_y:1
	canvas:
		Color:
			rgba:(0,0,0,1)
		Rectangle:
			size: self.size_hint
			pos: self.pos

<SectionLabel@Label>:
	font_size: 20
	bold: True
	color: (1, 1, 1, 1)

#popup to progress
<ProgressPop>:
	size_hint: 0.8, 0.2
	auto_dismiss: False

#-------------Custom Buttons-----------------------#
<DropBtn>:
	size_hint_y: None
	size_hint_x: 0.6
	height: "40dp"
	elevation_normal: 20
	opposite_colors: True

#---------------being used in 'Row' Class------------#
<ListItemLayout>:
	text: ''
	canvas.before:
		Color:
			rgba: (0,0,0,0)
		RoundedRectangle:
			pos: self.pos
			size: self.size


#---------------used in profile page----------#
<ListItemLayoutProfile@AnchorLayout>:
	text: ''
	canvas.before:
		Color:
			rgba: (0,0,0,0)
		RoundedRectangle:
			pos: self.pos
			size: self.size


<LabelForListStudent>:
	font_size:"20dp"
	bold: True
	color:(1,1,1,1) if app.theme_cls.theme_style=="Dark" else (0,0,0,1)

<LabelForList>:
	font_size:"20dp"
	bold: True
	color:(0,0,0,1) if app.theme_cls.theme_style=="Dark" else (1,1,1,1)
	
#-------------For Fee Reciept data --------------

<RowFeeRecipt>:
	canvas.before:
		Color:
			rgba: [1,1,1,1] if app.theme_cls.theme_style=="Dark" else (0,0,0,1) 
		Rectangle:
			pos: self.pos
			size: self.size		
	spacing: "10dp"

	reg: ''
	name: ''
	paid: ''
	due: ''

	#-------paid item--------#
	ListItemLayoutProfile:
		id: item1
		#size_hint:(0.10,1)
		LabelForList:
			id: lbl1
			text: root.reg
			
	#-------paid item--------#
	ListItemLayoutProfile:
		id: item2
		#size_hint:(0.13,1)
		LabelForList:
			id: lbl2
			text: root.name
			
	#-------due item--------#
	ListItemLayoutProfile:
		id: item3
		#size_hint:(0.13,1)
		LabelForList:
			id: lbl3
			text: root.paid
			
	#-------late item--------#
	ListItemLayoutProfile:
		id: item4
		#size_hint:(0.13,1)
		LabelForList:
			id: lbl4
			text: root.due
		

#---------------being used in Profile Page--------#
<Rowinfo>:
	color: (1,1,1,1) if app.theme_cls.theme_style=="Dark" else (0,0,0,1)

	canvas.before:
		Color:
			rgba: self.color 
		RoundedRectangle:
			pos: self.pos
			size: self.size		
	spacing: "10dp"

	sem:''
	paid: ''
	due: ''
	late:""
	date:''
	tid:""
	remarks:''
   
	#-------paid item--------#
	ListItemLayoutProfile:
		id: item1
		size_hint:(0.10,1)
		LabelForList:
			id: lbl1
			text: root.sem
			
	#-------paid item--------#
	ListItemLayoutProfile:
		id: item2
		size_hint:(0.13,1)
		LabelForList:
			id: lbl2
			text: root.paid
			
	#-------due item--------#
	ListItemLayoutProfile:
		id: item3
		size_hint:(0.13,1)
		LabelForList:
			id: lbl3
			text: root.due
			
	#-------late item--------#
	ListItemLayoutProfile:
		id: item4
		size_hint:(0.13,1)
		LabelForList:
			id: lbl4
			text: root.late
			
	#-------date item--------#
	ListItemLayoutProfile:
		id: item5
		size_hint:(0.13,1)
		LabelForList:
			id: lbl5
			text: root.date
			
	#-------Tid item--------#
	ListItemLayoutProfile:
		id: item6
		size_hint:(0.15,1)
		LabelForList:
			id: lbl6
			text: root.tid

	#-------remarks item--------#
	ListItemLayoutProfile:
		id: item7
		size_hint:(0.23,1)
		LabelForList:
			id: lbl7
			text: root.remarks
			
	BoxLayout:
		size_hint: None,1
		width:120

		HoverLayout:
			on_enter:
				btn0.text_color= [1,1,1,1]
				btn0.md_bg_color= [.5,.5,.5,.5]
			on_leave:
				btn0.text_color=[.4,.4,.4,1]
				btn0.md_bg_color= [.5,.5,.5,0]

			AnchorLayout:
				MDIconButton:
					id: btn0
					icon: "information-outline"
					theme_text_color: "Custom"
					md_bg_color:[.5,.5,.5,0]
					text_color: [.4,.4,.4,1]
					on_release:
						root.open_feeinfo_popup(root,app)

		HoverLayout:
			on_enter:
				btn1.text_color= [1,1,1,1]
				btn1.md_bg_color= [.5,.5,.5,.5]
			on_leave:
				btn1.text_color=[.4,.4,.4,1]
				btn1.md_bg_color= [.5,.5,.5,0]

			AnchorLayout:
				MDIconButton:
					id: btn1
					icon: "pencil"
					theme_text_color: "Custom"
					md_bg_color:[.5,.5,.5,0]
					text_color: [.4,.4,.4,1]
					on_release:
						root.edit(root, self.icon, app)
						

		HoverLayout:
			on_enter:
				btn2.text_color=[1,0,0,1]
				btn2.md_bg_color= [.5,.5,.5,.5]
			on_leave:
				btn2.text_color=[.4,0,0,1]
				btn2.md_bg_color= [.5,.5,.5,0]

			AnchorLayout:
				MDIconButton:
					id: btn2
					icon: "delete-forever"
					theme_text_color: "Custom"
					md_bg_color: [.5,.5,.5,0]
					text_color: [.4,0,0,1]
					on_release:
						root.delete(app, root, root.ids.btn1.icon)

<LabelAccountPage@Label>
	size_hint: None, None
	size: self.texture_size
	pos_hint: {'center_x': .5}

<BoxMinimumHeight@BoxLayout>
	size_hint_y: None
	height: self.minimum_height

<StudentInfoHeader@BoxLayout>:
	info_title: ''
	info_name: ''
	
	AnchorLayout:
		anchor_x: "right"
		Label:
			size_hint: None, None
			text: root.info_title
			size: self.texture_size
			bold: True
			font_size: sp(15)
	AnchorLayout:
		anchor_x: "left"
		Label:
			text: root.info_name
			size_hint: None, None
			size: self.texture_size
	
##--------------------List Items' Layout---------------------------------------###########
#being used in user screen
<Row@BoxLayout>:
	canvas.before:
		Color:
			#rgba:(.7,.7,.7,1) if app.theme_cls.theme_style=="Dark" else C("#17202A")
			#test
			rgba:(0,0,0,1) if app.theme_cls.theme_style=="Dark" else C("#ffffff")
		Rectangle:
			pos: self.pos
			size: self.size
	spacing: "10dp"

	sno: 0
	reg: 0
	name: ''
	course: ''
	stream: ''
	batch: ''

	#-------S. No. item--------#
	ListItemLayout:
		size_hint:(0.05,1)
		LabelForListStudent:
			id: lbl0
			text: str(root.sno)

	#---------reg. no.-----------#
	ListItemLayout:
		size_hint:(0.1,1)
		LabelForListStudent:
			id: lbl1
			text: str(root.reg)

	#-------name item--------#
	ListItemLayout:
		size_hint:(0.2,1)
		LabelForListStudent:
			id: lbl2
			text: root.name

	#-------course item--------#
	ListItemLayout:
		size_hint:(0.1,1)
		LabelForListStudent:
			id: lbl3
			text: root.course

	#-------stream item--------#
	ListItemLayout:
		size_hint:(0.1,1)
		LabelForListStudent:
			id: lbl4
			text: root.stream

	#-------batch item--------#
	ListItemLayout:
		size_hint:(0.1,1)
		LabelForListStudent:
			id: lbl5
			text: root.batch

<UserInfo>:
	txt_color:(0,0,0,1) if app.theme_cls.theme_style=="Dark" else (1,1,1,1)
	canvas.before:
		Color:
			rgba:(1,1,1,1) if app.theme_cls.theme_style=="Dark" else (0,0,0,1)#C("#17202A")
		RoundedRectangle:
			pos: self.pos
			size: self.size
	spacing: "10dp"

	sno:''
	name:''
	email:''
	username:''
	password:''
	false_pass:"********"

	ListItemLayoutProfile:
		size_hint:(0.3,1)
		LabelForList:
			text: root.sno
			bold: True

	ListItemLayoutProfile:
		#size_hint:(0.23,1)
		LabelForList:
			text: root.name
			bold: True

	ListItemLayoutProfile:
		#size_hint:(0.23,1)
		LabelForList:
			text: root.email
			bold: True

	ListItemLayoutProfile:
		#size_hint:(0.23,1)
		LabelForList:
			text: root.username
			bold: True

	ListItemLayoutProfile:
		#size_hint:(0.23,1)
		LabelForList:
			text: root.password
			bold: True

	BoxLayout:
		padding:0
		spacing:2
		size_hint: (None,1)
		width:90
		HoverLayout:
			on_enter:
				btn1.text_color= [1,1,1,1]
				btn1.md_bg_color= [.5,.5,.5,.5]
			on_leave:
				btn1.text_color=[.4,.4,.4,1]
				btn1.md_bg_color= [.5,.5,.5,0]
			
			MDIconButton:
				id:btn1
				size_hint: (.5,1)
				icon:"pencil"
				theme_text_color: "Custom"
				md_bg_color:[.5,.5,.5,0]
				text_color: [.4,.4,.4,1]
				#opposite_colors: True
				on_release:
					#root.verify_prev(root, self.icon, app)
					#root.edit(root, self.icon, app)
					app.root.ids.adminScreen.ids.user_layout.from_update=True
					app.root.ids.adminScreen.update_user_info(app.root.ids.adminScreen.ids.user_layout.ids.box,\
					app.root.ids.adminScreen.ids.plus, root
					)
					#self.icon= "check" if self.icon=="pencil" else "pencil"
		HoverLayout:
			on_enter:
				btn2.text_color=[1,0,0,1]
				btn2.md_bg_color= [.5,.5,.5,.5]
			on_leave:
				btn2.text_color=[.4,0,0,1]
				btn2.md_bg_color= [.5,.5,.5,0]

			MDIconButton:
				id:btn2
				size_hint: (.5,1)
				icon:"delete-forever"
				theme_text_color: "Custom"
				md_bg_color: [.5,.5,.5,0]
				text_color: [.4,0,0,1]
				#opposite_colors: True
				on_release:
					root.delete(app, root,root.ids.btn1.icon)
<RowUsersLogs>:
	canvas.before:
		Color:
			rgba: [1,1,1,1] if app.theme_cls.theme_style=="Dark" else (0,0,0,1) 
		Rectangle:
			pos: self.pos
			size: self.size		
	spacing: "10dp"
	
	dnt:''
	uname: ''
	activity: ''

	ListItemLayoutProfile:
		size_hint_x:1/4
		LabelForList:
			text:root.dnt

	ListItemLayoutProfile:
		size_hint_x:1/4
		LabelForList:
			text:root.uname
			
	ListItemLayoutProfile:
		LabelForList:
			text:root.activity


###For Notification Panel
<RowNotification>:
	canvas.before:
		Color:
			rgba: [1,1,1,1] if app.theme_cls.theme_style=="Dark" else (0,0,0,1) 
		Rectangle:
			pos: self.pos
			size: self.size		
	spacing: "10dp"
	
	sem:''
	toyear: ''
	fromyear: ''
	course: ''
	stream: ''
	category:''

	ListItemLayoutProfile:
		size_hint:(.18,1)
		LabelForList:
			text:root.sem

	ListItemLayoutProfile:
		size_hint:(.18,1)
		LabelForList:
			text:root.fromyear+"-"+root.toyear
			
	ListItemLayoutProfile:
		size_hint:(.18,1)
		LabelForList:
			text: root.course
			
	ListItemLayoutProfile:
		size_hint:(.18,1)
		LabelForList:
			text: root.stream

	ListItemLayoutProfile:
		size_hint:(.18,1)
		LabelForList:
			text: root.category
	
	ListItemLayoutProfile:
		size_hint:(.1,1)
		MDIconButton:
			opposite_colors:True
			icon:"delete"
			on_release:
				root.delete(root,app)

<CustomRecycleView>:
	scroll_type: ['bars', 'content']
	scroll_wheel_distance: dp(80)
	bar_width: dp(7)
	RecycleBoxLayout:
		default_size: None, dp(35)
		default_size_hint: 1, None
		size_hint_y: None
		height: self.minimum_height
		orientation: "vertical"
		spacing: dp(1)

<SoftwareModeLayout>:
	spacing:dp(20)
	padding:20,0,0,0
	MDTextField:
		id:lateFine
		size_hint_x:None
		width:dp(180)
		hint_text:"Late Fine After Due Date"
		write_tab:False
		input_filter:"int"
		multiline:False
	MDLabel:
		id:dueDate
		size_hint_x:None
		width:dp(120)
		text:"Select Due Date"
		color:app.theme_cls.primary_color
	MDIconButton:
		icon:"calendar-range"
		on_release:
			root.open_date_picker(app)

#-------------------------Add Data Layout------------------------------------#

<MultipleDataLayout>:
	doc_path:""
	size_hint_y:None
	height:60
	AnchorLayout:
		BoxLayout:
			size_hint: (1, .6)
			spacing: 20
			padding:0,0,120,0
			AnchorLayout:
				size_hint_x:None
				width:dp(70)
				BoxLayout:
					size_hint:(None,None)
					height:dp(10)
					width:dp(10)
					canvas:
						Color:
							rgba:app.theme_cls.primary_color
						Rectangle:
							size:self.size
							pos: self.pos

			InputFields:
				size_hint_x: .45
				input_filter:"int"
				id:paid
				hint_text: "Paid"
				on_text:
					self.text= self.text.strip()
			
			BoxLayout:
				size_hint_x: None
				width:140
				AnchorLayout:
					size_hint_x: None
					width:100
					padding:0,10,0,0
					MDTextButton:
						id:date
						text:"Select Date"
						on_release:
							root.open_date_picker()

				AnchorLayout:
					size_hint_x: None
					width:40
					MDIconButton:
						icon:"calendar-month"
						on_release:
							root.open_date_picker()
			
			InputFields:
				size_hint_x: .7
				id:tid
				hint_text: "Transaction id"
				on_text:
					self.text= self.text.strip()

			InputFields:
				id:rem
				hint_text: "Remarks"
				multiline: True
			
			BoxLayout:
				size_hint: None,1
				width: root.width/6 if len(root.ids.docName.text)>20 else dp(100)
				MDTextButton:
					id:docName
					text:"Upload File"
					on_release:
						root.open_FileSelector(root)

			BoxLayout:
				size_hint_x:None
				width:dp(130)
				MDIconButton:
					id:viewBtn
					icon:"eye"
					disabled:True
					opacity:0
					on_release:
						if root.ids.docName.text!="Upload File":\
						root.show_doc();\
						self.disabled=False;\
						self.opacity=1

				MDIconButton:
					id:uploadBtn
					icon:"upload"
					on_release:
						root.open_FileSelector(root)
						
				MDIconButton:
					icon:"delete"
					on_release:
						root.delete(root)
					

<InputFields@MDTextField>:
	write_tab:False

<FeeInfoPopup>:
	size_hint:.45,.8
	BoxLayout:
		orientation:"vertical"
		canvas:
			Color:
				rgba:(0,0,0,1) if app.theme_cls.theme_style=="Dark" else (1,1,1,1)
			Rectangle:
				pos:self.pos
				size:self.size
		BoxLayout:
			size_hint_y:.3
			canvas:
				Color:
					rgba:app.theme_cls.primary_color
				Rectangle:
					pos:self.pos
					size:self.size
			MDLabel:
				id:semLabel
				markup:True
				font_size:root.width/15
				halign:"center"
				color:(1,1,1,1)
		ScrollView:
			BoxLayout:
				orientation:"vertical"
				BoxLayout:
					padding:0,7,0,0
					size_hint_y:None
					height:40
					canvas:
						Color:
							rgba:app.theme_cls.primary_color
						Rectangle:
							pos:self.pos
							size:self.size
					MDLabel:
						size_hint_x:.25
						halign:"center"
						color:(1,1,1,1) 
						text:"Payment"
						bold:True
					MDLabel:
						size_hint_x:.25
						halign:"center"
						color:1,1,1,1
						text:"Date"
						bold:True
					MDLabel:
						size_hint_x:.5
						halign:"center"
						color:1,1,1,1
						text:"Trans. Id"
						bold:True
					Widget:
						size_hint_x:None
						width:20
					MDLabel:
						size_hint_x:None
						width:50
						color:1,1,1,1
						text:"Docs"
						bold:True
				BoxLayout:
					id:paymentData
					size_hint_y:None
					height:len(self.children)*60
					orientation:"vertical"
				Widget:

		AnchorLayout:
			size_hint_y:None
			padding:0,0,15,15
			height:40
			anchor_x:"right"
			MDRaisedButton:
				text:"Dismiss"
				on_release:root.dismiss()
<FeeInfoData>:
	orientation:"vertical"
	BoxLayout:
		size_hint_y:None
		height:60

		MDLabel:
			size_hint_x:.25
			halign:"center"
			color:(1,1,1,1)if app.theme_cls.theme_style=="Dark" else(0,0,0,1)
			text:root.paid
		MDLabel:
			size_hint_x:.25
			halign:"center"
			color:(1,1,1,1)if app.theme_cls.theme_style=="Dark" else(0,0,0,1)
			text:root.date
		MDLabel:
			size_hint_x:.5
			halign:"center"
			color:(1,1,1,1)if app.theme_cls.theme_style=="Dark" else(0,0,0,1)
			text:root.tid
		MDIconButton:
			size_hint_x:None
			width:70
			icon:"eye"
			disabled: True if root.filename=="" else False
			on_release:root.view_doc()
	MDSeparator:

<AddDataLayout>:
	size_hint_x:1
	size_hint_y:None
	height:295 
	pos_hint: {'y': -0.3}
	auto_dismiss:False
	on_open: app.root.ids.profilePage.anim_out(root)
	on_dismiss: app.root.ids.profilePage.anim_in(root)

	from_update: False	#whether called for updating data

	BoxLayout:
		size_hint:(1,1)
		orientation:"vertical"
		padding:0,45,0,0
		spacing:dp(35)
		canvas:
			Color:
				rgba:(1,1,1,1) if app.theme_cls.theme_style=="Light" else C("#17202A")
			RoundedRectangle:
				size:self.size
				pos: self.pos
				radius:[10,10,0,0]
		BoxLayout:
			size_hint: (1, None)
			height:dp(35)
			padding: 10
			spacing: 20
			InputFields:
				size_hint_x: None
				width:dp(130)
				input_filter:"int"
				id:sem
				hint_text: "Semester"
				on_text:
					self.text= self.text.strip()

			MDLabel:
				size_hint_x:None
				width:dp(80)
				color:app.theme_cls.primary_color
				text:"Late Fine"

			MDCheckbox:
				id:lateCheckbox
				size_hint_x:None
				width:dp(30)
				on_state:
					root.late_fine_layout(self)


			AnchorLayout:
				anchor_x:"right"
				padding:0,0,30,0
				MDRaisedButton:
					text:"Add More Data"
					on_release:
						root.add_more_data_layout() if len(root.ids.multipleDataContainer.children)<6 else None
		
		BoxLayout:
			size_hint_y:None
			height:dp(60)
			id:multipleDataContainer
			orientation:"vertical"
			MultipleDataLayout:


		AnchorLayout:
			size_hint_y:None
			height:dp(70)
			anchor_x:"right"
			BoxLayout:
				size_hint:(None,1)
				padding:0,0,0,10
				width:dp(150)
				spacing:dp(20)
				MDFloatingActionButton:
					icon: 'check'
					opposite_colors: True
					elevation_normal: 8
					md_bg_color: app.theme_cls.primary_color
					on_release:
						app.root.ids.profilePage.add_fee_data(root) if not root.from_update else\
						app.root.ids.profilePage.update_fee_data(root)
				MDFloatingActionButton:
					icon: 'window-close'
					opposite_colors: True
					elevation_normal: 8
					md_bg_color: app.theme_cls.primary_color
					on_release:root.dismiss()

<HoverOneLineListItem>:
	_color:[0,0,0,0]
	canvas:
		Color:
			rgba: root._color
		Rectangle:
			pos: self.pos
			size: self.size
	on_enter:
		self._color=[.5,.5,.5,.2]

	on_leave:
		self._color=[0,0,0,0]

#being used in manage student section
<UpdateStudentLayout>:
	id: updateInfoLayout
	name: ''
	email: ''
	batch: ''
	course: ''
	stream: ''

	orientation: 'vertical'
	BoxLayout:
		orientation: 'vertical'
		spacing: 10
		#name
		BoxLayout:
			padding: 10,0
			AnchorLayout:
				MDTextField:
					write_tab: False
					hint_text: "Name"
					text: root.name
					on_text: root.name= self.text
		
		#email
		BoxLayout:
			padding: 10,0
			AnchorLayout:
				MDTextField:
					write_tab: False
					hint_text: "Email"
					text: root.email
					on_text: root.email= self.text


		#batch
		BoxLayout:
			padding: 10,0
			AnchorLayout:
				MDTextField:
					write_tab: False
					hint_text: "Batch"
					text: root.batch
					on_text: root.batch= self.text
	#course and stream
	AnchorLayout:
		spacing: 50
		BoxLayout:
			spacing: 50
			size_hint: None, None
			width: self.minimum_width
			height: self.minimum_height

			MDRaisedButton:
				size_hint: None, None
				size: 100, 50
				id:courseBtn
				elevation_normal:10
				opposite_colors: True
				text: root.course
				on_release:
					app.root.ids.adminScreen.openCourseList(self)

			MDRaisedButton:
				size_hint: None, None
				size: 100, 50
				id:streamBtn
				elevation_normal:10
				opposite_colors: True
				text: root.stream
				on_release:
					app.root.ids.adminScreen.openStreamList(self)

<DeleteWarning>:
	size_hint:.4,.4
	text:"Delete:\n"+self.delete_detail+"?"
	pos_hint: {'x': 1.4}
	on_open: self.anim_out(self)
	on_dismiss: self.anim_in(self)
	BoxLayout:
		id:container
		orientation:"vertical"
		canvas:
			Color:
				rgba: app.theme_cls.primary_color
			RoundedRectangle:
				size:self.size
				pos:self.pos
				radius:10,0,0,10
		BoxLayout:
			padding:self.width*.2,0,0,0
			Label:
				text:root.text
				text_size: self.size
				halign: 'left'
				valign: 'middle'
				font_size:self.height/30+self.width/29
		BoxLayout:
			canvas:
				Color:
					rgba:1,1,0,0
				RoundedRectangle:
					size:self.size
					pos:self.pos
					radius:10,0,0,10
			AnchorLayout:
				id:check
				MDFloatingActionButton:
					icon:"check"
					on_release:
						root.delete(app, self.text_color)
				
			AnchorLayout:
				MDFloatingActionButton:
					icon:"window-close"
					id:delete
					on_release:
						root.dismiss()
			
		BoxLayout:
			size_hint_y:.3

#root of the app
ScreenManager:
	HomeScreen:
		id: homeScreen
	UserScreen:
		id: userScreen
	AdminScreen:
		id: adminScreen
	ProfilePage:
		id: profilePage
	NotificationScreen:
		id: notificationScreen
	

#-------------------ProfilePage---------------------#
<ProfilePage>:
	name: 'profilepage'
	FloatLayout:
		canvas:
			Color:
				rgba: C(root.color)
			Rectangle:
				size: self.size
				pos: self.pos

		BoxLayout:
			orientation: 'vertical'
			spacing: dp(5)

			BoxMinimumHeight:
				padding:0,2,0,0

				Widget:
					size_hint: None, 1
					width: 20

				MDIconButton:
					size_hint: None, None
					size: 50,50
					icon: 'arrow-left'
					md_bg_color: app.theme_cls.primary_color
					theme_text_color: "Custom"
					text_color: [1,1,1,1]
					on_release:
						app.root.transition= FallOutTransition();app.root.current= "userScreen"
				

			BoxMinimumHeight:
				orientation: 'vertical'
				padding: 0, dp(15), 0, 0
				spacing: dp(7)
				pos_hint: {'top': 1}
				Image:
					size_hint: None, None
					size: self.size
					source: 'media/images/user.png'
					pos_hint: {'center_x': .5}
				LabelAccountPage:
					id: name
					halign: 'center'
					font_size: '30sp'
					bold: True
				LabelAccountPage:
					id: roll
					halign: 'center'
					font_size: '18sp'
				LabelAccountPage:
					id: email
					halign: 'center'
					font_size: '18sp'
					
			BoxLayout:
				id: box
				orientation: 'vertical'
				spacing: dp(10)
				padding: dp(10)
				opacity: 0
				canvas.before:
					Color:
						rgba:(1, 1, 1, .7) if app.theme_cls.theme_style=="Light" else C("#1B2631")
					RoundedRectangle:
						radius: [10,10,0,0]
						size: self.size
						pos: self.pos
				BoxMinimumHeight:
					spacing: dp(10)
					padding: 2, 0, 10, 0
					BoxLayout:
						canvas:
							Color:
								rgba: 0, 0, 0, .7
							RoundedRectangle:
								size: self.size
								pos: self.pos
						id: button
						size_hint_x: None
						size_hint_y:None
						height:40
						StudentInfoHeader:
							id: course
							info_title: "Course: "
						StudentInfoHeader:
							id: stream
							info_title: "Stream: "
						StudentInfoHeader:
							id: batch
							info_title: "Batch: "
						StudentInfoHeader:
							id: fee
							info_title: "Fee: "
							
			
					MDIconButton:
						id: printbtn
						icon: "file-pdf-outline"
						size_hint: None, None
						size: 40,40
						opposite_colors: True
						md_bg_color: app.theme_cls.primary_color
						theme_text_color: 'Custom'
						text_color: [1,1,1,1] if app.theme_cls.theme_style=="Dark" else [0,0,0,1]
						on_release:
							root.print_pdf()
							
				BoxLayout:
					orientation:"vertical"
					spacing:2
					BoxLayout:
						size_hint_y:None
						height:40
						canvas:
							Color:
								rgba: 0, 0, 0, .7
							RoundedRectangle:
								size: self.size
								pos: self.pos
						BoxLayout:
							size_hint:.10,1
							Label:
								text:"Semester"
						BoxLayout:
							size_hint:.12,1
							Label:
								text:"Total Paid"
						BoxLayout:
							size_hint:.12,1
							Label:
								text:"Due"
						BoxLayout:
							size_hint:.13,1
							Label:
								text:"Late Fine"
						BoxLayout:
							size_hint:.13,1
							Label:
								text:"Last Date"
						BoxLayout:
							size_hint:.15,1
							Label:
								text:"Last Trans.Id"
						BoxLayout:
							size_hint:.22,1
							Label:
								text:"Last Remarks"
						BoxLayout:
							size_hint:.09,1
							
					BoxLayout:
						canvas:
							Color:
								rgba:.6,.3,0.1,0
							RoundedRectangle:
								pos:self.pos
								size:self.size
						RecycleView:
							id: rv
							scroll_type: ['bars', 'content']
							scroll_wheel_distance: dp(80)
							bar_width: dp(7)
							viewclass: 'Rowinfo'
							data:[]
							RecycleBoxLayout:
								id: rb
								default_size: None, dp(56)
								default_size_hint: 1, None
								size_hint_y: None
								height: self.minimum_height
								orientation: "vertical"
								spacing: dp(5)
		MDFloatingActionButton:
			icon: "plus"
			md_bg_color: app.theme_cls.primary_color
			x: root.width/2-self.width/2
			y: dp(15)
			on_release:root.open_add_data_layout()

#--------------------------HomeScreen-----------------------------------------###
<HomeScreen>:
	name:"homeScreen"

	BoxLayout:
		orientation: 'vertical'
		canvas.before:
			Rectangle:
				pos: self.pos
				size: self.size
				source:root.selectWallpaper(app.theme_cls.theme_style)

		BoxLayout:
			size_hint: (1,0.2)
			orientation: 'vertical'


			
			#####-----------logo + IIIt Kalyani -----------
			BoxLayout:
				size_hint: (1,.4)
				canvas:
					Color:
						rgba:9/255, 96/255, 235/255,0
					Rectangle:
						pos: self.pos
						size: self.size
				BoxLayout:
					size_hint: (.15, 1)
				AnchorLayout:
					size_hint: (.15,1)
					Image:
						source: "media/images/logo.png"
						size: self.texture_size

				BoxLayout:
					
					size_hint: (.6,1)
					orientation: 'vertical'
					BoxLayout:
						Label:
							text:"IIIT KALYANI"
							color:(1,1,1,1) if app.theme_cls.theme_style=="Dark" else (0,0,0,1)
							text_size: self.size
							font_size: self.height/17+self.width/17

							
					BoxLayout:
						Label:
							text_size: self.size
							text:"ACCOUNT MANAGEMENT SYSTEM"
							color:(1,1,1,1) if app.theme_cls.theme_style=="Dark" else (0,0,0,1)
							font_size: self.height/22+self.width/22
							halign: 'left'
							valign: 'middle'
					
				BoxLayout:
					orientation:"vertical"
					spacing:-28
					size_hint: (.1,1)
					
					AnchorLayout:
						size_hint_y:.7
						Button:
							size_hint: None, None
							size: 80,80
							#text: "User"
							border: (0, 0, 0, 0)
							background_normal: 'media/images/admin3.png' if app.theme_cls.theme_style=="Light" else 'media/images/admin3_white.png'
							background_down: 'media/images/admin3_down.png'
							on_release:
								root.openLoginPop("Admin")
					AnchorLayout:
						size_hint_y:.3
						Label:
							text: "ADMIN"
							color:(1,1,1,1) if app.theme_cls.theme_style=="Dark" else (0,0,0,1)
							bold: True
							font_size: dp("15")
					

			######----------------------------------------------

		BoxLayout:
			size_hint: (1,.35)
				

		BoxLayout:
			orientation: 'vertical'
			size_hint: (1,0.45)

			#contains main buttons------------------------------
			BoxLayout:
				size_hint: (1,0.4)

				AnchorLayout:

					anchor_x: 'center'
					anchor_y: 'center'

					Button:
						size_hint: None, None
						size: 150,174
						#text: "User"
						border: (0, 0, 0, 0)
						background_normal: 'media/images/multi_user3.png' if app.theme_cls.theme_style=="Light" else 'media/images/multi_user3_white.png'
						background_down: 'media/images/multi_user3_down.png'

						on_release:
							root.openLoginPop("User")

			BoxLayout:
				size_hint:1,.1
			##-------------Button------------------------###############
			AnchorLayout:
				size_hint:1,.2

				BoxLayout:
					size_hint_x:.25

					MDFillRoundFlatButton:
						opacity:.9
						size_hint:1,1
						text: "Work Space"
						font_size:self.width/10
						on_release:
							root.openLoginPop("User")

			#blankkkkkkk-------------__#######
			BoxLayout:
				size_hint: (1,0.3)


<ForgotPasswordScreen>:
	BoxLayout:
		opacity: 3.0
		spacing:10
		padding: [10, 0]
		orientation:"vertical"
		canvas:
			Color:
				rgba:0,1,0,0
			RoundedRectangle:
				pos:self.pos
				size:self.size
				radius:25,25,25,25
		BoxLayout:
			size_hint_y:.15
			spacing:-20
			AnchorLayout:
				size_hint_x:None
				width:30
				anhor_x:"left"
				MDIconButton:
					icon:"arrow-left"
					theme_text_color:"Custom"
					text_color:1,1,1,1
					on_release:
						root.parent.transition=SwapTransition()
        				root.parent.parent.opacity=0.6
        				root.parent.current='login'

			MDLabel:
				text:"Reset Password"
				font_size:self.width*.08
				halign:"center"
				color:1,1,1,1
		MDLabel:
			id:verifnLabel
			size_hint_y:.1
			text:"Send a Verification Code to Your Email"
			color:1,1,1,1
		BoxLayout:
			id:sendCodeBox
			spacing:60
			size_hint_y:.1
			MDRaisedButton:
				id:sendBtn
				text:"Send Code"
				on_release:
					root.pre_verify_code()

			MDLabel:
				id:statusLabel

		BoxLayout:
			id:codeSubmitBox
			spacing:50
			size_hint_y:.15

		AnchorLayout:
			opacity:1
			size_hint_y:.5
			BoxLayout:
				id:resetPasswordBox
				size_hint:.5,1
				spacing:5
				orientation:"vertical"
							
####--------------------------Login Popup Class------------------------------------####

<LoginPopup>:
	#size_hint: (0.4, 0.7)
	size_hint: (0.3, 0.5)
	auto_dismiss: True
	background: "media/images/image.png"
	opacity:0.6
	 

	ScreenManager:
		id:scr

		Screen:
			name:"login"
   #####-------------------Parent Boxlayout----------------------------######################

			BoxLayout:
				orientation: 'vertical'
				canvas:
					Color:
						rgba: (1,0,1,0)
					Rectangle:
						pos: self.pos
						size: self.size

				#------------------------title------------------------------------------#############
				AnchorLayout:
					size_hint: (1, .2)

					canvas:
						Color:
							rgba: (1,0,1,0)
						Rectangle:
							pos: self.pos
							size: self.size

					Label:
						opacity:3
						id: loginTitle
						text: ""
						font_size: dp(35)
						bold: True
						color: (1, 1, 1, 1)


				AnchorLayout:
					size_hint: (1, 0.8)
					canvas:
						Color:
							rgba: (1,0,0.5,0)
						Rectangle:
							pos: self.pos
							size: self.size

					#####------------------contains textInputs------------------------------#
					GridLayout:
						opacity:3
						size_hint: (0.7, 1)
						canvas:
							Color:
								rgba: (0.5,0,1,0)
							Rectangle:
								pos: self.pos
								size: self.size


						rows: 2
						cols: 1

						FloatLayout:
							size_hint_y:.5
							canvas:
								Color:
									rgba: (0.5,0,.2,0)
								Rectangle:
									pos: self.pos
									size: self.size

							BoxLayout:
								id: util_box
								orientation: 'vertical'
								pos_hint: {"center_x":0.5, "center_y": 0.5}
								size_hint: None, None
								size: self.parent.width, self.parent.height
								opacity:1
								angle: 0
								origin_: (0,0)
								axis: tuple((0,0,1))
								

								canvas.before:
									PushMatrix
									Rotate:
										axis: self.axis
										angle: self.angle 
										origin: self.origin_ or self.center

									Color:
										rgba: 1,1,0,0
									Rectangle:
										pos: self.pos
										size: self.size
								canvas.after:
									PopMatrix

								#-----------------Wrong credential info-------------#
								BoxLayout:
									size_hint: (1, 0.1)
									canvas:
										Color:
											rgba: (0.5,0.3,1,0)
										Rectangle:
											pos: self.pos
											size: self.size

									Label:
										id: warningInfo
										text: ''
										color: (1, 0, 0, 1)	

								#-----------------------username-----------------#
								AnchorLayout:
									canvas:
										Color:
											rgba: (0.3,0,0.2,0)
										Rectangle:
											pos: self.pos
											size: self.size

									BoxLayout:
										size_hint: (1, None)
										height: 40
										canvas:
											Color:
												rgba: (0,0,0,0)
											Rectangle:
												pos: self.pos
												size: self.size

										#---------username input----------#
										BoxLayout:
											size_hint: (1,1)
											canvas:
												Color:
													rgba: (0.5,0.2,0.3,0)
												Rectangle:
													pos: self.pos
													size: self.size
											MDTextFieldRound:
												id: username_
												size_hint: (1, 1)
												hint_text:"Username"
												icon_type:'left'
												icon_left: 'account-box'
												cursor_width: sp(5)
												cursor_color:[1,1,1,1]
												foreground_color: (0, 0, 0, 1)
												text_validate_unfocus:False
												on_text_validate:
													x= root.login(root.ids.username_.text, root.ids.password_.text,\
													root.ids.loginTitle.text, app.root)
													if (x and root.ids.loginTitle.text=="User Login"):\
													app.root.transition= SlideTransition(direction="right");\
													app.root.current= "userScreen";\
													app.root.ids.userScreen.onStartUserScr()

													if (x and root.ids.loginTitle.text=="Admin Login"):\
													app.root.transition= SlideTransition(direction="left");\
													app.root.current= "adminScreen";\
													app.root.ids.adminScreen.onStartAdminScr()

								#-------------------password---------------------------#
								AnchorLayout:
									canvas:
										Color:
											rgba: (1,0,1,0)
										Rectangle:
											pos: self.pos
											size: self.size
									BoxLayout:
										size_hint: (1, None)
										height: 40
										canvas:
											Color:
												rgba: (0,0,0,0)
											Rectangle:
												pos: self.pos
												size: self.size
										#---------password input----------#
										BoxLayout:
											size_hint: (1,1)
											canvas:
												Color:
													rgba: (0,0,0,0)
												Rectangle:
													pos: self.pos
													size: self.size
											MDTextFieldRound:
												id: password_
												size_hint: (1, 1)
												hint_text:"Password"
												foreground_color: (0, 0, 0, 1)
												text_validate_unfocus:False
												cursor_width: sp(5)
												cursor_color:[1,1,1,1]
												icon_left: 'key-variant'
												icon_right: 'eye-off'
												password: True
												icon_callback: root.show_password

												on_text_validate:
													x= root.login(root.ids.username_.text, root.ids.password_.text,\
													root.ids.loginTitle.text, app.root)
													if (x and root.ids.loginTitle.text=="User Login"):\
													app.root.transition= SlideTransition(direction="right");\
													app.root.current= "userScreen";\
													app.root.ids.userScreen.onStartUserScr()

													if (x and root.ids.loginTitle.text=="Admin Login"):\
													app.root.transition= SlideTransition(direction="left");\
													app.root.current= "adminScreen";\
													app.root.ids.adminScreen.onStartAdminScr()

						#-------------Login Btn Area----------------------------------#
						AnchorLayout:
							size_hint: (1, 0.5)
							canvas:
								Color:
									rgba: (0.5,0.5,0.5,0)
								Rectangle:
									pos: self.pos
									size: self.size
					
							#-------------------Contains login button and forgot password----------------------------------#
							BoxLayout:
								orientation: 'vertical'
								#size_hint: (1, 0.5)
								canvas:
									Color:
										rgba: (1,0,1,0)
									Rectangle:
										pos: self.pos
										size: self.size

								#-------------Login Btn Area----------------------------------#
								AnchorLayout:
									size_hint: (1, 0.5)
									canvas:
										Color:
											rgba: (0.5,0.5,0.5,0)
										Rectangle:
											pos: self.pos
											size: self.size

									#-----------------login btn-------------#
									BoxLayout:
										size_hint: (1, None)
										height: dp(40)
										MDFillRoundFlatButton:
											size_hint:1,1
											border: (10, 10, 10, 10)
											text: "Login"
											on_release:
												x= root.login(root.ids.username_.text, root.ids.password_.text,\
												root.ids.loginTitle.text, app.root)
												if (x and root.ids.loginTitle.text=="User Login"):\
												app.root.transition= SlideTransition(direction="right");\
												app.root.current= "userScreen";\
												app.root.ids.userScreen.onStartUserScr()

												if (x and root.ids.loginTitle.text=="Admin Login"):\
												app.root.transition= SlideTransition(direction="left");\
												app.root.current= "adminScreen";\
												app.root.ids.adminScreen.onStartAdminScr()


								#--------------forgot password area---------------------------#
								AnchorLayout:
									size_hint: (1, 0.5)
									canvas:
										Color:
											rgba: (0.3,0.3,0.3,0)
										Rectangle:
											pos: self.pos
											size: self.size

									MDTextButton:
										size_hint: (0.5, 0.3)
										text:"Forgot Details?"
										on_release:
											root.check_caller(root.ids.loginTitle.text)
											
		ForgotPasswordScreen:
			name:"reset"

		ForgotPasswordUser:
			name:"reset_user"
			BoxLayout:
				opacity: 3.0
				spacing:10
				padding: [10, 0]
				orientation:"vertical"
				canvas:
					Color:
						rgba:0,1,0,0
					RoundedRectangle:
						pos:self.pos
						size:self.size
						radius:25,25,25,25
				BoxLayout:
					size_hint_y:.15
					spacing:-20
					AnchorLayout:
						size_hint_x:None
						width:30
						anhor_x:"left"
						MDIconButton:
							icon:"arrow-left"
							theme_text_color:"Custom"
							text_color:1,1,1,1
							on_release:
								root.ids.scr.transition=SwapTransition()
								root.opacity=0.6
								root.ids.scr.current='login'

					MDLabel:
						text:"Reset Password"
						font_size:self.width*.08
						halign:"center"
						color:1,1,1,1
				
				AnchorLayout:
					size_hint_y:.75
					MDLabel:
						halign:"center"
						text:"Please contact Admin !"
						color:1,1,1,1




#-----------------------------------------------USERS SCREEN----------------------------------------###

<UserScreen>:
	name: "userScreen"
	user_name:''

	BoxLayout:
		orientation: 'vertical' 

		#---------------------------header Area--------------------------------------###
		BoxLayout:
			id:header
			size_hint: (1, 0.07)
			canvas:
				Color:
					rgba: app.theme_cls.primary_color
				Rectangle:
					pos: self.pos
					size: self.size

			#-----------------hamburger button--------------------##
			AnchorLayout:
				size_hint: (0.1, 1)

				MDIconButton:
					id: hamburger
					icon: "menu"
					theme_text_color: "Custom"
					text_color: [1,1,1,1]
					size: sp(50), sp(50)
					on_release:
						root.open_sideNav()

			#-----------------file info area-----------------------##
			BoxLayout:
				size_hint: (0.5, 1)

				Label:
					id:batchLabel
					text: ""
					halign: "center"
					color: (0, 0, 0, 1)
					font_size: 30

			#-----------------search area-------------------------###
			AnchorLayout:
				size_hint: (0.25, 1)

				MDTextFieldRound:
					id: search
					size_hint: (0.8,None)
					hint_text:"Search"
					icon_left: 'magnify'
					icon_type:'left'
					hint_text_color:0,0,0,0.7
					active_color: [1, 1, 1, .7]
					normal_color: [.3, .3, 0.3, .5]
					text_size: dp(30)
					foreground_color: 0,0,0,1
					on_text:
						root.search(self.text.strip())

		#-----------------------body section------------------------------------#################
		BoxLayout:
			size_hint: (1, 0.9)
			orientation: 'vertical'

			BoxLayout:
				orientation:"vertical"
				BoxLayout:
					size_hint: (1, 0.08)
					canvas:
						Color:
							rgb: C("#000000")
						Rectangle:
							pos: self.pos
							size: self.size
					Section:
						size_hint_x: 0.05
						SectionLabel:
							text: "S.No."

					Section:
						size_hint_x: 0.1
						SectionLabel:
							text: "Reg. No."

					Section:
						size_hint_x: 0.2
						SectionLabel:
							text: "Name"

					Section:
						size_hint_x: 0.1
						SectionLabel:
							text: "Course"

					Section:
						size_hint_x: 0.1
						SectionLabel:
							text: "Stream"

					Section:
						size_hint_x: 0.1
						SectionLabel:
							text: "Batch"

				#-------------------------------list area-----------------------------------###########
				BoxLayout:
					canvas:
						Color:
							rgba:(1,1,1,1) if app.theme_cls.theme_style=="Dark" else (0,0,0,1)
						Rectangle:
							size:self.size
							pos:self.pos
					id: list_area
					size_hint: (1,0.93)
					spacing:"5dp"
					RecycleView:
						id: rv
						scroll_type: ['bars', 'content']
						scroll_wheel_distance: dp(100)
						bar_width: dp(7)
						viewclass: 'Row'
						data: []
						RecycleBoxLayout:
							default_size: None, dp(56)
							default_size_hint: 1, None
							size_hint_y: None
							height: self.minimum_height
							orientation: "vertical"
							spacing: .5


#--------------------------------Admin Screen--------------------------------------########
<AdminScreen>:
	name:"adminScreen"
	id:adminScreen
	BoxLayout:
		orientation: 'vertical'
		canvas:
			Color:
				rgba:(0,0,0,1) if app.theme_cls.theme_style=="Dark" else (1,1,1,1)
			Rectangle:
				pos:self.pos
				size:self.size 
		#-----------title Bar------------#
		AnchorLayout:
			size_hint: (1,0.07)
			canvas:
				Color:
					rgba: app.theme_cls.primary_color
				Rectangle:
					pos: self.pos
					size: self.size
			Label:
				id: top_bar
				text:"Admin: Manage User"
				font_size:26
		#------------Main Layout ---------#
		BoxLayout:
			size_hint: (1,0.96)
			#-------------Side Navigation---------#
			BoxLayout:
				orientation: 'vertical'
				size_hint: (0.13,1)
				canvas:
					Color:
						rgb: C("#ECF0F1") if app.theme_cls.theme_style=="Light" else C("#283747")
					Rectangle:
						pos: self.pos
						size: self.size

				#----------ToggleButtons in here--------------#
				AnchorLayout:
					anchor_y: 'top'
					size_hint: (1,0.3)
					#padding:10
					
					MDList:
						HoverOneLineListItem:
							text:"Manage User"
							on_release:
								root.change_screen(self)

						HoverOneLineListItem:
							text:"Manage Student"
							on_release:
								root.change_screen(self)		

						HoverOneLineListItem:
							text:"Admin Setting"
							on_release:
								root.change_screen(self)
							
						HoverOneLineListItem:
							text:"Users Logs"
							on_release:
								root.change_screen(self)

				AnchorLayout:
					size_hint: (1,0.1)
					#---------------------logout layout----------#########

					BoxLayout:
						size_hint: (1,None)
						height:"50dp"
						
						BoxLayout:
							size_hint: (.7, 1)	
							Button:
								background_color: (1,1,1,0)

								text:"Logout"
								font_size:self.width/4
								color:(0,0,0,1) if app.theme_cls.theme_style=="Light" else (1,1,1,1)
								bold: True
								on_release:
									app.root.transition= SlideTransition(direction="right")
									app.root.current="homeScreen"
						BoxLayout:
							size_hint: (.3, 1)
							MDIconButton:
								id:logoutbtn
								icon:"logout"
								size: self.height, self.width
								on_release:
									app.root.transition= SlideTransition(direction="right")
									app.root.current="homeScreen"

			#------------Working Layout---------------------#
			BoxLayout:
				size_hint: (0.83,1)
				ScreenManager:
					id:scrManager

					#---------------Manage User Screen-----------#
					Screen:
						name:"manageUser"
						
						MDFloatingActionButton:
							id:plus
							icon:"plus"
							ratio_x: self.width/root.ids.user_layout.ids.box.width
							ratio_y: self.height/self.parent.height
							pos_x: self.ratio_x*1/1.8
							pos_y: self.ratio_y*1/1.8
							curr_height: root.ids.user_layout.ids.box.height+root.ids.user_layout.ids.box.y
							height_rat: self.curr_height/self.parent.height
							pos_hint:{"center_x":1-self.pos_x, "center_y":self.pos_y+self.height_rat}

							on_release:
								root.add_user_layout(root.ids.user_layout.ids.box, self)

						BoxLayout:
							spacing:8
							orientation: 'vertical'
							#------------------Users Data types Label------------------#
							BoxLayout:
								#rows: 1
								#cols: 
								size_hint: (1,None)
								size: (0,40)
								canvas:
									Color:
										rgba:app.theme_cls.primary_color
									Rectangle:
										pos: self.pos
										size: self.size

									#------add user button-----------------#
								BoxLayout:
									#size_hint: (None, 1)
									#width: self.minimum_width
									size_hint_x: 0.3
									Label:
										text:"S.No."
										bold:True
								BoxLayout:
									Label:
										text:"Name"
										bold:True
								BoxLayout:
									Label:
										text:"E-Mail"
										bold:True
								BoxLayout:
									Label:
										text:"Userame"
										bold:True
								BoxLayout:
									Label:
										text:"Password"
										bold:True
								BoxLayout:
									size_hint: None, None
									size: (100, 40)

							#------------------Users Data------------------#
							BoxLayout:
								size_hint: (1,0.715)
								spacing:"5dp"
								RecycleView:
									id: rv
									scroll_type: ['bars', 'content']
									scroll_wheel_distance: dp(80)
									bar_width: dp(7)
									viewclass: 'UserInfo'
									RecycleBoxLayout:
										id: rbl
										default_size: None, dp(45)
										default_size_hint: 1, None
										size_hint_y: None
										height: self.minimum_height
										orientation: "vertical"
										spacing: dp(4)
			
							#----dynamic Layout With Fields-------#
							BoxLayout:
								size_hint: (1,0.08)
								id:dyn_input
								spacing:5
								padding:2

							AddUserDataLayout:
								id: user_layout


					#----------------manage Student Screen-------------##
					Screen:
						name:"manageStudent"

						MDTabs:
							id: tab_panel
							tab_display_mode:'text'

							MyTab:
								
								name: 'addBatch'
								text: "Add Batch"
								icon: "plus"

								BoxLayout:						
									orientation: 'vertical'
									
									AnchorLayout:						
										size_hint: (1,.87)

										BoxLayout:
											orientation: 'vertical'
											size_hint: (.3,1)
											padding: 20,48,20,0
											spacing:30
											
											MDTextField:
												id: fromYear1
												hint_text:"From Year"
												input_filter: "int"
												write_tab: False
												multiline: False
												on_text:
													self.text =self.text[:4] if len(self.text)>4 else self.text

											MDTextField:
												id: toYear1
												hint_text:"To Year"
												input_filter: "int"
												write_tab: False
												multiline: False
												on_text:
													self.text =self.text[:4] if len(self.text)>4 else self.text

											MDTextField:
												id: fee1
												hint_text:"Fee"
												input_filter: "int"
												write_tab: False
												multiline: False

											AnchorLayout:
												spacing: 50
												BoxLayout:
													spacing: 50
													size_hint: None, None
													width: self.minimum_width
													height: self.minimum_height


													MDRaisedButton:
														size_hint: None, None
														size: 100, 40
														id:courseBtn1
														elevation_normal:10
														opposite_colors: True
														text:"Select Course"
														on_release:root.openCourseList(self)
													MDRaisedButton:
														size_hint: None, None
														size: 100, 40
														id:streamBtn1
														elevation_normal:10
														opposite_colors: True
														text:"Select Stream"
														on_release:root.openStreamList(self)
											BoxLayout:
												size_hint: 1,None
												height: 50
												MDRaisedButton:
													size_hint: 1,1
													text: 'Upload xls file'
													elevation_normal: 10
													opposite_colors: True
													on_release:
														root.connectFileSelector(fromYear1.text,toYear1.text,\
														courseBtn1.text, streamBtn1.text, fee1.text)
									BoxLayout:
										size_hint: (1,.13)

							MyTab:
								id: deleteBatch
								name: 'deleteBatch'
								text: 'Delete Batch'
								icon: "delete"
								BoxLayout:							
									orientation: 'vertical'
									
									AnchorLayout:						
										size_hint: (1,.7)

										BoxLayout:
											orientation: 'vertical'
											size_hint: (.3,1)
											padding: 20,50,20,0
											spacing:50

											MDTextField:
												id: fromYear2
												hint_text:"From Year"
												input_filter: "int"
												write_tab: False
												multiline: False
												on_text:
													self.text =self.text[:4] if len(self.text)>4 else self.text

											MDTextField:
												id: toYear2
												hint_text:"To Year"
												input_filter: "int"
												write_tab: False
												multiline: False
												on_text:
													self.text =self.text[:4] if len(self.text)>4 else self.text

											AnchorLayout:
												
												BoxLayout:
													spacing: 50
													size_hint: None, None
													width: self.minimum_width
													height: self.minimum_height


													MDRaisedButton:
														size_hint: None, None
														size: 100, 40
														id:courseBtn2
														elevation_normal:10
														opposite_colors: True
														text:"Select Course"
														on_release:root.openCourseList(self)
													MDRaisedButton:
														size_hint: None, None
														size: 100, 40
														id:streamBtn2
														elevation_normal:10
														opposite_colors: True
														text:"Select Stream"
														on_release:root.openStreamList(self)
											BoxLayout:
												
												size_hint: (1,None)
												height: 50
												MDRaisedButton:
													size_hint:(1,1)
													text: 'Delete Batch'
													elevation_normal: 10
													opposite_colors: True
													on_release:
														root.deleteBatch(fromYear2.text, toYear2.text,\
														courseBtn2.text, streamBtn2.text)
									BoxLayout:
										size_hint: (1,.2)

							MyTab:
								id: updateStudent
								name: 'updateStudent'
								text: 'Update Student Details'
								icon: "update"
								BoxLayout:							
									orientation: 'vertical'
									
									AnchorLayout:						
										size_hint: (1,.7)

										BoxLayout:
											orientation: 'vertical'
											size_hint: (.3,1)
										
											BoxLayout:
												size_hint_y: .4
												AnchorLayout:
													MDTextField:
														size_hint_x: None
														width: 250
														id: reg_no
														hint_text:"Registration number to be updated"
														input_filter: "int"
														write_tab: False
														multiline: False
														on_text:
															self.text =self.text[:3] if len(self.text)>3 else self.text
															root.checkBeforeUpdate(self.text, parentAnchor)

											AnchorLayout:
												id: parentAnchor
												
											BoxLayout:
												size_hint_y: .17
												MDRaisedButton:
													id:update
													size_hint: (1,1)
													text: 'Update'
													elevation_normal: 10
													opposite_colors: True
													on_release:
														root.updateStudentInfo(reg_no.text,parentAnchor)
									BoxLayout:
										size_hint: (1,.2)

					#----------------Manage Admin Setting--------------#
					Screen:
						name:"adminSetting"
						BoxLayout:
							padding:10,10,10,10
							BoxLayout:
								spacing:10
								size_hint:.5,1
								orientation:"vertical"

								#Basic Details
								BoxLayout:
									padding:10
									orientation:"vertical"		
										
									BoxLayout:
										size_hint_y:.1
										MDLabel:
											size_hint_x: .15
											font_size: self.width/7
											id:lbl
											text:"Admin Details"
											color:(0,0,0,1) if app.theme_cls.theme_style=="Light" else (1,1,1,1)
											
											
										BoxLayout:
											size_hint_x:1-root.ids.lbl.size_hint_x
											canvas:
												Color:
													rgba:app.theme_cls.primary_color
												SmoothLine:
													points:[self.x, self.y+self.height/2,self.x+self.width, self.y+self.height/2]
													width:dp(1.15)

									GridLayout:
										id:adminInfoLayout
										size_hint_y:.8
										cols:2
										AdminInfoLabel:
											title:"Name"
											text:''
										AdminInfoLabel:
											title:"Email Id"
											text:''
										AdminInfoLabel:
											title:"Mobile no."
											text:''
										AdminInfoLabel:
											title:"Alt. Email Id"
											text:''
									
									AnchorLayout:
										size_hint_y:.1
										anchor_x:"right"
										MDIconButton:
											id:adminInfoEditBtn
											icon:"pencil"
											md_bg_color: app.theme_cls.primary_color
											on_release:
												root.edit_admin_info() if self.icon=="pencil" else root.show_admin_info()
								
									

								#Basic Credential
								BoxLayout:
									padding:10
									orientation:"vertical"
									BoxLayout:
										size_hint_y:.1
										MDLabel:
											size_hint_x:.18
											font_size:self.width/8
											id:lbl1
											text:"Change Credential"
											color: (0,0,0,1) if app.theme_cls.theme_style=="Light" else (1,1,1,1)
											
											
										BoxLayout:
											size_hint_x:1-root.ids.lbl1.size_hint_x
											canvas:
												Color:
													rgba:app.theme_cls.primary_color
												SmoothLine:
													points:[self.x, self.y+self.height/2,self.x+self.width, self.y+self.height/2]
													width:dp(1)

									GridLayout:
										#orientation:"vertical"
										cols:1
										size_hint_y:.9
										BoxLayout:
											size_hint_y:None
											height:60
											BoxLayout:
												BoxLayout:
													id:adminUsernameLayout
													AdminInfoLabel:
														title:"Username"
														text:''
												MDIconButton:
													id:adminUsernameEditBtn
													icon:"pencil"
													md_bg_color: app.theme_cls.primary_color
													on_release:
														root.edit_admin_username() if self.icon=="pencil" else root.show_admin_username()

											BoxLayout:
											

											BoxLayout:
												BoxLayout:
													id:adminPasswordLayout
													AdminInfoLabel:
														title:"Password"
														text:"********" if (root.ids.eyeBtn.state=="normal") else root.admin_password
												BoxLayout:
													MDIconButton:
														id:eyeBtn
														icon:"eye"
														on_state:
															root.on_eye_btn_pressed(self,1) if root.flag==1 else None
		
													MDIconButton:
														id:adminPasswordEditBtn
														icon:"pencil"
														md_bg_color: app.theme_cls.primary_color
														on_release:
															root.edit_admin_password() if self.icon=="pencil" else root.show_admin_password()
										#Notification Mail 
										BoxLayout:
											size_hint_y:None
											height:60
											BoxLayout:
												BoxLayout:
													id:notMailLayout
													AdminInfoLabel:
														title:"Notification Email"
														text:root.not_mail
												MDIconButton:
													id:notMailEditBtn
													icon:"pencil"
													md_bg_color: app.theme_cls.primary_color
													on_release:
														root.edit_not_mail() if self.icon=="pencil" else root.show_not_mail()

											BoxLayout:
											

											BoxLayout:
												BoxLayout:
													id:notMailPassLayout
													AdminInfoLabel:
														title:"Notification Email Password"
														text:"********" if (root.ids.eyeBtn1.state=="normal") else root.not_mail_password
												BoxLayout:
													MDIconButton:
														id:eyeBtn1
														icon:"eye"
														on_state:
															root.on_eye_btn_pressed(self,2) if root.flag1==1 else None
		
													MDIconButton:
														id:notMailPassEditBtn
														icon:"pencil"
														md_bg_color: app.theme_cls.primary_color
														on_release:
															root.edit_not_mail_password() if self.icon=="pencil" else root.show_not_mail_password()
										BoxLayout:
										BoxLayout:
											MDLabel:
												markup:True
												text:"**Notification Email is for sending fee notification mail to students"
												font_size:dp(13)
												color: (0,0,0,1) if app.theme_cls.theme_style=="Light" else (1,1,1,1)
					
					#----------------Userslog--------------#
					Screen:
						name:"usersLogs"
						
						BoxLayout:
							orientation:"vertical"
							BoxLayout:
								orientation:"vertical"
								size_hint_y:None
								height:50
								padding:20,10,0,4
								MDLabel:
									text:"Logs"
									font_size:dp(25)
									color: (0,0,0,1) if app.theme_cls.theme_style=="Light" else (1,1,1,1)
							BoxLayout:
								size_hint_y:None
								height:dp(1.5)
								canvas:
									Color:
										rgba:app.theme_cls.primary_color
									SmoothLine:
										points:[self.x, self.y+self.height/2,self.x+self.width, self.y+self.height/2]
										width:dp(1.5)
							Widget:
								size_hint_y:None
								height:dp(5)
							BoxLayout:
								size_hint_y:None
								height:dp(35)
								canvas:
									Color:
										rgba:(0,0,0,1) if app.theme_cls.theme_style=='Light' else (.8,.8,.8,1)
									Rectangle:
										pos:self.pos
										size:self.size

								LabelForList:
									size_hint_x:1/4
									text:"Date & Time"
								LabelForList:
									size_hint_x:1/4
									text:"Username"
								LabelForList:
									text:"Activity"
							Widget:
								size_hint_y:None
								height:dp(2)

							BoxLayout:
								id:logList
								Image:
									source:"media/images/no_data.png"




#-----------------------Notification Screen Starts----------------##
#working
<NotificationScreen>:
	id:notificationScreen
	name:"notificationScreen"
	BoxLayout:
		orientation:"vertical"
		canvas:
			Color:
				rgba:(0,0,0,1) if app.theme_cls.theme_style=="Dark" else (1,1,1,1)
			Rectangle:
				pos:self.pos
				size:self.size
		#---------------------------header Area--------------------------------------###
		BoxLayout:
			id:header
			size_hint: (1, 0.08)
			canvas:
				Color:
					rgba: app.theme_cls.primary_color
				Rectangle:
					pos: self.pos
					size: self.size
			AnchorLayout:
				size_hint_x:None
				width:50
				MDIconButton:
					icon:"arrow-left"
					on_release:
						app.root.transition= SlideTransition(direction="right")
						app.root.current="userScreen"
			Label:
				text:"Utilities"
				bold:True
				font_size:25
				
		BoxLayout:
			id:main_area
			BoxLayout:
				size_hint_x:.2
				canvas:
					Color:
						rgba:(.9,.9,.9,1) if app.theme_cls.theme_style=="Light" else (.1,.1,.1,1)
					Rectangle:
						pos:self.pos
						size:self.size
				ScrollView:
					MDList:
						OneLineIconListItem:
							text:"Notification Panel"
							on_release:
								root.ids.scr_manager_tools.current="notificationScreen"
							IconLeftWidget:
								icon:"email-edit-outline"

						OneLineIconListItem:
							text:"Generate PDF"
							on_release:
								root.ids.scr_manager_tools.current="pdfgenerationScreen"
							IconLeftWidget:
								icon:"file-pdf-outline"
			BoxLayout:
				size_hint_x:.80
				ScreenManager:
					id:scr_manager_tools

					#---Notification Screen-----
					Screen:
						name:"notificationScreen"
						BoxLayout:
							orientation:"vertical"
							BoxLayout:
								size_hint_y:.08
								AnchorLayout:
									anchor_x:"left"
									BoxLayout:
										MDIconButton:
											icon:"email-edit-outline"
											user_font_size: sp(root.height/20)
										MDLabel:
											text:"Notification Panel"
											color:(1,1,1,1) if app.theme_cls.theme_style=="Dark" else (0,0,0,1)
							BoxLayout:
								size_hint_y:.01
								canvas:
									Color:
										rgba:app.theme_cls.primary_color
									SmoothLine:
										points:[self.x, self.y+self.height/2,self.x+self.width, self.y+self.height/2]
										width:dp(2)

							BoxLayout:
								orientation:"vertical"
								size_hint_y:.91
								ScrollView:
									BoxLayout:
										id:notificationContainer
										orientation:"vertical"
										size_hint_y:None
										height:dp(880)
										BoxLayout:
											size_hint_y:None
											height:dp(70)
											spacing:dp(50)
											padding:20,0,20,0
											MDTextField:
												id:notSemester
												hint_text:"Semester"
												write_tab:False
												input_filter:"int"
												multiline:False
												on_text:
													self.text =self.text[:2] if len(self.text)>2 else self.text
											MDTextField:
												id:notFromyear
												hint_text:"From Year"
												write_tab:False
												input_filter:"int"
												multiline:False
												on_text:
													self.text =self.text[:4] if len(self.text)>4 else self.text
											MDTextField:
												id:notToyear
												hint_text:"To Year"
												write_tab:False
												input_filter:"int"
												multiline:False
												on_text:
													self.text =self.text[:4] if len(self.text)>4 else self.text
											MDRaisedButton:
												id:notCourse
												text:"Select Course"
												on_release:
													root.openCourseListNotification(self)
											MDRaisedButton:
												id:notStream
												text:"Select Stream"
												on_release:
													root.openStreamListNotification(self)

											MDRaisedButton:
												id:notCategory
												text:"Due"
												on_release:
													root.openCategoryListNotification(self)

											MDIconButton:
												icon:"plus"
												md_bg_color:app.theme_cls.primary_color
												on_release:
													root.get_data(app)

										#Selected Batches for Email
										MDLabel:
											size_hint_y:None
											height:dp(40)
											text:"Selected Batches:"
											color:(1,1,1,1) if app.theme_cls.theme_style=="Dark" else (0,0,0,1)
											font_size:dp(20)
										BoxLayout:
											size_hint_y:None
											height:dp(1)
											canvas:
												Color:
													rgba:app.theme_cls.primary_color
												SmoothLine:
													points:[self.x, self.y+self.height/2,self.x+self.width, self.y+self.height/2]
										Widget:
											size_hint_y:None
											height:dp(2)

										BoxLayout:
											id:listLabel
											opacity:0
											size_hint_y:None
											height:dp(35)
											canvas:
												Color:
													rgba:(0,0,0,1) if app.theme_cls.theme_style=="Light" else (.8,.8,.8,1)
												Rectangle:
													pos:self.pos
													size:self.size
											LabelForList:
												size_hint_x:.18
												text:"Semester"
												color:(1,1,1,1)
												bold:True
											LabelForList:
												size_hint_x:.18
												text:"Batch"
												color:(1,1,1,1)
												bold:True
											LabelForList:
												size_hint_x:.18
												text:"Course"
												color:(1,1,1,1)
												bold:True
											LabelForList:
												size_hint_x:.18
												text:"Stream"
												color:(1,1,1,1)
												bold:True
											LabelForList:
												size_hint_x:.18
												text:"Category"
												color:(1,1,1,1)
												bold:True
											Widget:
												size_hint_x:.10

										BoxLayout:
											id:batchList
											size_hint_y:None
											height:dp(43)
											padding:0,1,0,0
											Label:
												text:"No Data Added"
												color:(1,1,1,1) if app.theme_cls.theme_style=="Dark" else (0,0,0,1)

										#Message Mode 
										BoxLayout:
											size_hint_y:None
											height:dp(100)
											orientation:"vertical"
											MDLabel:
												text:"Message Mode:"
												font_size:dp(20)
												color:(1,1,1,1) if app.theme_cls.theme_style=="Dark" else (0,0,0,1)
											BoxLayout:
												size_hint_y:None
												height:dp(1)
												canvas:
													Color:
														rgba:app.theme_cls.primary_color
													SmoothLine:
														points:[self.x, self.y+self.height/2,self.x+self.width, self.y+self.height/2]
											BoxLayout:
												padding:50,0,50,0
												MDLabel:
													text:"Self Generated"
													color:(1,1,1,1) if app.theme_cls.theme_style=="Dark" else (0,0,0,1)
												MDCheckbox:
													id:checkbox1
													size_hint: None, None
													size: dp(48), dp(48)
													active:True
													on_state:
														root.mode_selection(0) if self.state=="down" else None
														root.ids.checkbox2.active=True if self.state=="normal" else False
												Widget:
													size_hint_x:None
													width:dp(150)
												MDLabel:
													text:"Software Generated"
													color:(1,1,1,1) if app.theme_cls.theme_style=="Dark" else (0,0,0,1)
												MDCheckbox:
													id:checkbox2
													size_hint: None, None
													size: dp(48), dp(48)
													on_state:
														root.mode_selection(1) if self.state=="down" else None
														root.ids.checkbox1.active=True if self.state=="normal" else False

						
											
										#This Field Depends on which Message Mode Selected
										BoxLayout:
											id:messageMode
											size_hint_y:None
											height:60
											
											

										#This Container is for message Box
										BoxLayout:
											TextInput:
												id:messageBox
												size_hint:None,None
												height:dp(400)
												width:dp(500)
												hint_text:"Message"
												multiline:True

										AnchorLayout:
											padding:0,0,30,0
											size_hint_y:None
											height:dp(100)
											anchor_x:"right"
											MDRaisedButton:
												id:sendBtn
												text:"Send Notification"
												on_release: root.send_notification()
								

					#---Pdf Generator Screen----
					Screen:
						name:"pdfgenerationScreen"
						BoxLayout:
							orientation:"vertical"
							BoxLayout:
								size_hint_y:.08
								AnchorLayout:
									anchor_x:"left"
									BoxLayout:
										MDIconButton:
											icon:"file-pdf-outline"
											user_font_size: sp(root.height/20)
										MDLabel:
											text:"Generate Pdf"
											color:(1,1,1,1) if app.theme_cls.theme_style=="Dark" else (0,0,0,1)

							BoxLayout:
								size_hint_y:.01
								canvas:
									Color:
										rgba:app.theme_cls.primary_color
									SmoothLine:
										points:[self.x, self.y+self.height/2,self.x+self.width, self.y+self.height/2]
										width:dp(2)

							BoxLayout:
								size_hint_y:.91
								orientation: 'vertical'
								BoxLayout:
									padding:20,0,20,0
									spacing:40						
									size_hint_y:.1
									MDTextField:
										id:sem
										size_hint_x:1/5
										hint_text:"Semester"
										write_tab:False
										input_filter:"int"
										multiline:False
										on_text:
											self.text =self.text[:2] if len(self.text)>2 else self.text
											data={\
											"sem":root.ids.sem.text,\
											"from_year":root.ids.fromyear.text,\
											"to_year":root.ids.toyear.text,\
											"course":root.ids.course.text,\
											"stream":root.ids.stream.text,\
											"category":root.ids.category.text\
											}
											root.apply_filter(data)

									MDTextField:
										id:fromyear
										size_hint_x:1/5
										hint_text:"From Year"
										write_tab:False
										input_filter:"int"
										multiline:False
										on_text:
											self.text =self.text[:4] if len(self.text)>4 else self.text
											data={\
											"sem":root.ids.sem.text,\
											"from_year":root.ids.fromyear.text,\
											"to_year":root.ids.toyear.text,\
											"course":root.ids.course.text,\
											"stream":root.ids.stream.text,\
											"category":root.ids.category.text\
											}
											root.apply_filter(data)

									MDTextField:
										id:toyear
										size_hint_x:1/5
										hint_text:"To Year"
										write_tab:False
										input_filter:"int"
										multiline:False
										on_text:
											self.text =self.text[:4] if len(self.text)>4 else self.text
										
											data={\
											"sem":root.ids.sem.text,\
											"from_year":root.ids.fromyear.text,\
											"to_year":root.ids.toyear.text,\
											"course":root.ids.course.text,\
											"stream":root.ids.stream.text,\
											"category":root.ids.category.text\
											}
											root.apply_filter(data)

									MDRaisedButton:
										id:course
										text:"Course"
										size_hint:None,None
										width:dp(200)
										height:dp(40)
										on_release:
											root.openCourseList(self)
											data={\
											"sem":root.ids.sem.text,\
											"from_year":root.ids.fromyear.text,\
											"to_year":root.ids.toyear.text,\
											"course":root.ids.course.text,\
											"stream":root.ids.stream.text,\
											"category":root.ids.category.text\
											}
											
									MDRaisedButton:
										id:stream
										text:"Stream"
										size_hint:None,None
										width:dp(200)
										height:dp(40)
										on_release:
											root.openStreamList(self)
											data={\
											"sem":root.ids.sem.text,\
											"from_year":root.ids.fromyear.text,\
											"to_year":root.ids.toyear.text,\
											"course":root.ids.course.text,\
											"stream":root.ids.stream.text,\
											"category":root.ids.category.text\
											}

									MDRaisedButton:
										id:category
										text:"All"
										size_hint:None,None
										width:dp(200)
										height:dp(40)
										on_release:
											root.openCategoryList(self)
											data={\
											"sem":root.ids.sem.text,\
											"from_year":root.ids.fromyear.text,\
											"to_year":root.ids.toyear.text,\
											"course":root.ids.course.text,\
											"stream":root.ids.stream.text,\
											"category":root.ids.category.text\
											}
											
									MDRaisedButton:
										text:"Generate Pdf"
										size_hint:None,None
										width:dp(200)
										height:dp(40)
										on_release:
											data={\
											"sem":root.ids.sem.text,\
											"from_year":root.ids.fromyear.text,\
											"to_year":root.ids.toyear.text,\
											"course":root.ids.course.text,\
											"stream":root.ids.stream.text,\
											"category":root.ids.category.text\
											}
											root.generate_fee_receipt_batch(data)
									
								Widget:
									size_hint_y:.01
								BoxLayout:
									size_hint_y:.06
									canvas:
										Color:
											rgba:(.8,.8,.8,1) if app.theme_cls.theme_style=="Dark" else (0,0,0,1)
										Rectangle:
											pos:self.pos
											size:self.size
									MDLabel:
										text:"Reg No."
										color:1,1,1,1
										bold:True
										halign:"center"
									MDLabel:
										text:"Name"
										color:1,1,1,1
										bold:True
										halign:"center"
									MDLabel:
										text:"Paid"
										color:1,1,1,1
										bold:True
										halign:"center"
									MDLabel:
										text:"Due"
										color:1,1,1,1
										bold:True
										halign:"center"

								BoxLayout:
									size_hint_y:.83
									#spacing:1
									RecycleView:
										id: rv
										scroll_type: ['bars', 'content']
										scroll_wheel_distance: dp(80)
										bar_width: dp(7)
										viewclass: 'RowFeeRecipt'
										#data:[{"reg":"213","name":"Anand Kumar","paid":"10000","due":"20111"},{"reg":"213","name":"Anand Kumar","paid":"10000","due":"20111"}]
										RecycleBoxLayout:
											default_size: None, dp(45)
											default_size_hint: 1, None
											size_hint_y: None
											height: self.minimum_height
											orientation: "vertical"
											spacing: dp(1)


<SideNav>:
	size_hint: (0.2, 1)
	pos_hint: {'x': -.3}
	on_open: app.root.ids.userScreen.anim_out(root)
	on_dismiss: app.root.ids.userScreen.anim_in(root)
	BoxLayout:
		orientation: 'vertical'
		canvas:
			Color:
				rgba: (0.2,0.2,0.2,1) if app.theme_cls.theme_style=="Dark" else (1,1,1,1)
			Rectangle:
				pos: self.pos
				size: self.size
		#--------------User Icon---------------------------#
		AnchorLayout:
			size_hint: (1,0.4)
			canvas:
				Color:
					rgba: (0, 1, 1, 1)
				Rectangle:
					pos: (self.x, self.y)
					size: self.size


			Image:
				source: 'media/images/user_logout_pic.png'
				size_hint: None, None
				size: 140,145
		#------------User name and Logout Button-------------#
		BoxLayout:
			orientation:"vertical"
			ScrollView:
				MDList:
					TwoLineAvatarIconListItem:
						id: user_name
						canvas.before:
							Color:
								rgba:app.theme_cls.primary_color
							Rectangle:
								pos:self.pos
								size:self.size
						text:""
						secondary_text:"User"
						ListLeftIconButton:
							icon:"account"
							user_font_size: "30sp"
						ListRightIconButton:
							icon:"logout"
							on_release:
								app.root.transition= SlideTransition(direction="left")
								app.root.current='homeScreen'
								root.dismiss()
								#userlog
								dnt= strftime("%d-%m-%Y %H:%M:%S")
								uname= root.ids.user_name.text
								activity= activities["logout"]
								create_log(dnt,uname,activity)

					MDSeparator:

					OneLineIconListItem:
						text:"Personalization"
						on_release:
							root.open_personalisation()
						IconLeftWidget:
							icon:"brush"

					MDSeparator:
					
					OneLineIconListItem:
						text:"Utilities"
						on_release:
							app.root.transition= SlideTransition(direction="left")
							app.root.current="notificationScreen"
							root.dismiss()
						IconLeftWidget:
							icon:"toolbox-outline"

###Popup Where User can change theme 
<Personalisation>:
	auto_dismiss:False
	size_hint:.35,.5
	BoxLayout:
		orientation:"vertical"
		canvas:
			Color:
				rgba:(0.1,0.1,0.1,1) if app.theme_cls.theme_style=="Dark" else (1,1,1,1)
			Rectangle:
				pos:self.pos
				size:self.size
		BoxLayout:
			size_hint_y:.3
			canvas:
				Color:
					rgba:app.theme_cls.primary_color
				Rectangle:
					pos:self.pos
					size:self.size
			MDLabel:
				color:(1,1,1,1) if app.theme_cls.theme_style=="Dark" else (0,0,0,1)
				text:"Pesonalisation"
				font_size:30
				halign:"center"
		BoxLayout:
			size_hint_y:.7
			orientation:"vertical"
			BoxLayout:
				size_hint_y:.7
				ScrollView:
					MDList:
						OneLineAvatarIconListItem:
							text: "Dark Mode"
							ListRightSwitch:
								active: True if app.theme_cls.theme_style=="Dark" else False
								on_active:
									app.theme_cls.theme_style="Dark" if self.active\
									else "Light"



						TwoLineAvatarIconListItem:
							text: "Theme"
							secondary_text: "Current: " + app.theme_cls.theme_style + ", " + app.theme_cls.primary_palette
							ListRightIconButton:
								icon:"brush"
								on_release:
									root.theme_picker_open()
			AnchorLayout:
				padding:0,0,20,0
				size_hint_y:.3
				anchor_x:"right"
				MDRaisedButton:
					text:"Ok"
					on_release:
						root.dismiss()


<AddUserDataLayout>:
	#Layout to add/update users
	from_update: False
	
	size_hint_y:None
	height: dp(65)
	#canvas:
	#	Color:
	#		rgba:1,0,0,0
	#	Rectangle:
	#		pos: self.pos
	#		size: self.size

	BoxLayout:
		id: box
		size_hint_y:None
		height: dp(60)
		y: -self.height

		padding:60,0
		spacing:60

		canvas:
			Color:
				rgba: app.theme_cls.accent_color
			Rectangle:
				pos:self.pos
				size:self.size

		InputFields:
			size_hint_x: .2
			id:name
			hint_text: "Name"
			on_text:
				btn= app.root.ids.adminScreen.ids.plus
				root.manage_icon(btn)
			on_text_validate:
				pass
		
		InputFields:
			size_hint_x: .2
			id:email
			hint_text: "Email"
			on_text:
				btn= app.root.ids.adminScreen.ids.plus
				root.manage_icon(btn)
			on_text_validate:
				pass
		
		InputFields:
			size_hint_x: .2
			id:username
			hint_text: "Username"
			on_text:
				btn= app.root.ids.adminScreen.ids.plus
				root.manage_icon(btn)
			on_text_validate:
				pass
		
		InputFields:
			size_hint_x: .2
			id:password
			hint_text: "Password"
			on_text:
				btn= app.root.ids.adminScreen.ids.plus
				root.manage_icon(btn)
			on_text_validate:
				pass

#-------------------------Drop Downs Buttons--------------------------#
<CourseDrop>:
	DropBtn:
		text:"B.Tech"
		on_release: root.select(self)
	DropBtn:
		text:"Ph.D"
		on_release: root.select(self)

<StreamDrop>:
	DropBtn:
		text:"CSE"
		on_release: root.select(self)
	DropBtn:
		text:"ECE"
		on_release: root.select(self)

<CategoryDrop>:
	nfs:app.root.ids.notificationScreen
	on_select:
		data={\
		"sem":self.nfs.ids.sem.text,\
		"from_year":self.nfs.ids.fromyear.text,\
		"to_year":self.nfs.ids.toyear.text,\
		"course":self.nfs.ids.course.text,\
		"stream":self.nfs.ids.stream.text,\
		"category":args[1].text\
		}
		self.nfs.apply_filter(data)

	DropBtn:
		text:"All"
		on_release: root.select(self)
	DropBtn:
		text:"Due"
		on_release: root.select(self)
		
<CourseDropFee>:
	nfs:app.root.ids.notificationScreen
	on_select:
		data={\
		"sem":self.nfs.ids.sem.text,\
		"from_year":self.nfs.ids.fromyear.text,\
		"to_year":self.nfs.ids.toyear.text,\
		"course":args[1].text,\
		"stream":self.nfs.ids.stream.text,\
		"category":self.nfs.ids.category.text\
		}
		self.nfs.apply_filter(data)

	DropBtn:
		text:"All"
		on_release: root.select(self)
	DropBtn:
		text:"B.Tech"
		on_release: root.select(self)
	DropBtn:
		text:"Ph.D"
		on_release: root.select(self)

	

<StreamDropFee>:
	nfs:app.root.ids.notificationScreen
	on_select:
		data={\
		"sem":self.nfs.ids.sem.text,\
		"from_year":self.nfs.ids.fromyear.text,\
		"to_year":self.nfs.ids.toyear.text,\
		"course":self.nfs.ids.course.text,\
		"stream":args[1].text,\
		"category":self.nfs.ids.category.text\
		}
		self.nfs.apply_filter(data)
	
	DropBtn:
		text:"All"
		on_release: root.select(self)
	DropBtn:
		text:"CSE"
		on_release: root.select(self)
	DropBtn:
		text:"ECE"
		on_release: root.select(self)
